# 一、安装 #

程序包下载后，可直接解压启动运行，例如Mac平台:

    unzip emqttd-macosx-v2.0.zip && cd emqttd

启动emqttd

    ./bin/emqttd start

检查运行状态

    ./bin/emqttd_ctl status

停止emqttd

    ./bin/emqttd stop


# 100万线连接测试说明 #

EMQ 2.0消息服务器默认设置，允许最大客户端连接是512，因为大部分操作系统’ulimit -n’限制为1024。
EMQ 消息服务器1.1.3版本，连接压力测试到130万线，8核心/32G内存的CentOS云服务器。

操作系统内核参数、TCP协议栈参数、Erlang虚拟机参数、EMQ最大允许连接数设置简述如下：

Linux操作系统参数

## 2M - 系统所有进程可打开的文件数量: ##

    sysctl -w fs.file-max=2097152    
    sysctl -w fs.nr_open=2097152

## 1M - 系统允许当前进程打开的文件数量: ##

    ulimit -n 1048576

TCP协议栈参数

# backlog - Socket监听队列长度:

sysctl -w net.core.somaxconn=65536
Erlang虚拟机参数

emqttd/etc/emq.conf:

## Erlang Process Limit
node.process_limit = 2097152

## Sets the maximum number of simultaneously existing ports for this system
node.max_ports = 1048576
EMQ 最大允许连接数

emqttd/etc/emq.conf ‘listeners’段落:

## Size of acceptor pool
mqtt.listener.tcp.acceptors = 64

## Maximum number of concurrent clients
mqtt.listener.tcp.max_clients = 1000000

## 安装erlang ##
    sudo yum install erlang

## 安装git客户端 ##
    sudo yum install git

# 性能测试客户端安装 #
https://github.com/emqtt/emqtt_benchmark

